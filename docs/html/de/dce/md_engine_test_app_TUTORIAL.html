<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>matf-rg-engine: Test App Tutorial</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">matf-rg-engine
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Base for project for the Computer Graphics course at Faculty of Mathematics, University of Belgrade</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Test App Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>To demonstrate most of the <code>engine</code> features, let's recreate part of the <code>engine/test/app</code> in this tutorial.</p>
<h1><a class="anchor" id="autotoc_md28"></a>
1. The TestApp class</h1>
<p>The first thing we need to do is to create a class that extends the <code>engine::app::App</code> class and override the <code>App::user_setup</code> method, let's call it <code>TestApp</code>.</p>
<p>In the <code>include/app</code> create <code><a class="el" href="../../d4/dcf/TestApp_8hpp.html">TestApp.hpp</a></code></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d3/d48/Engine_8hpp.html">engine/core/Engine.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="../../d7/dac/namespaceengine_1_1test_1_1app.html">engine::test::app</a> {</div>
<div class="line">    <span class="keyword">class </span>TestApp final : <span class="keyword">public</span> <a class="code" href="../../d0/d12/classengine_1_1core_1_1App.html">engine::core::App</a> {</div>
<div class="line">        <span class="keywordtype">void</span> setup() <span class="keyword">override</span>;</div>
<div class="line">    };</div>
<div class="line">}</div>
<div class="ttc" id="aEngine_8hpp_html"><div class="ttname"><a href="../../d3/d48/Engine_8hpp.html">Engine.hpp</a></div><div class="ttdoc">Includes all the engine headers.</div></div>
<div class="ttc" id="aclassengine_1_1core_1_1App_html"><div class="ttname"><a href="../../d0/d12/classengine_1_1core_1_1App.html">engine::core::App</a></div><div class="ttdoc">Defines the base App class that serves as the application core structure and the entry point.</div><div class="ttdef"><b>Definition:</b> App.hpp:45</div></div>
<div class="ttc" id="anamespaceengine_1_1test_1_1app_html"><div class="ttname"><a href="../../d7/dac/namespaceengine_1_1test_1_1app.html">engine::test::app</a></div><div class="ttdef"><b>Definition:</b> GUIController.hpp:6</div></div>
</div><!-- fragment --><p>The only file we need to include to use the <code>engine</code> is the <code>&lt;<a class="el" href="../../d3/d48/Engine_8hpp.html" title="Includes all the engine headers.">engine/core/Engine.hpp</a>&gt;</code>.</p>
<p>And in the <code>src/</code> create <code><a class="el" href="../../db/dd3/TestApp_8cpp.html">TestApp.cpp</a></code>, define <code>TestApp::user_setup()</code> and <code>main</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d4/dcf/TestApp_8hpp.html">app/TestApp.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;spdlog/spdlog.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="../../d7/dac/namespaceengine_1_1test_1_1app.html">engine::test::app</a> {</div>
<div class="line">    <span class="keywordtype">void</span> TestApp::user_setup() {</div>
<div class="line">        spdlog::info(<span class="stringliteral">&quot;Hello, TestApp::user_setup&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="../../db/dd3/TestApp_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">    <span class="keywordflow">return</span> std::make_unique&lt;engine::test::app::TestApp&gt;()-&gt;run(argc, argv);</div>
<div class="line">}</div>
<div class="ttc" id="aTestApp_8cpp_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="../../db/dd3/TestApp_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> TestApp.cpp:14</div></div>
<div class="ttc" id="aTestApp_8hpp_html"><div class="ttname"><a href="../../d4/dcf/TestApp_8hpp.html">TestApp.hpp</a></div></div>
</div><!-- fragment --><p>The <code>TestApp::user_setup()</code> prints "Hello, TestApp::user_setup". The main function creates a new instance of our app <code>std::make_unique&lt;<a class="el" href="../../df/d33/classengine_1_1test_1_1app_1_1TestApp.html">engine::test::app::TestApp</a>&gt;()</code> and calls <code><a class="el" href="../../d0/d12/classengine_1_1core_1_1App.html#a424c3d6b2ec7410fcde36a2c3c19d435" title="The main entry point into the App.">engine::core::App::run</a></code>.</p>
<p>Now lets build and run this app and we should see a trace and an empty window:</p>
<div class="fragment"><div class="line">[2024-12-14 15:57:40.098] [info] ArgParser initialized.</div>
<div class="line">[2024-12-14 15:57:40.098] [info] Configuration initialized.</div>
<div class="line">[2024-12-14 15:57:40.098] [info] Hello, TestApp::user_setup &lt;--- Here is our `TestApp::user_setup()` .</div>
<div class="line">[2024-12-14 15:57:40.098] [info] PlatformGLFW3Controller::initialize</div>
<div class="line">[2024-12-14 15:57:40.527] [info] Platform[GLFW 3.5.0]</div>
<div class="line">[2024-12-14 15:57:40.527] [info] GraphicsController::initialize</div>
<div class="line">[2024-12-14 15:57:40.528] [info] ResourcesController::initialize</div>
</div><!-- fragment --><p>The method <code>App::run</code> runs the application:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> run(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    engine_setup(argc, argv); &lt;--- This where `TestApp::user_setup` is called</div>
<div class="line">    initialize();</div>
<div class="line">    <span class="keywordflow">while</span> (loop()) {</div>
<div class="line">        poll_events();</div>
<div class="line">        update();</div>
<div class="line">        draw();</div>
<div class="line">    }</div>
<div class="line">    terminate();</div>
<div class="line">  } <span class="keywordflow">catch</span>(...) { ... }</div>
<div class="line">  <span class="keywordflow">return</span> on_exit();</div>
<div class="line">}</div>
</div><!-- fragment --><p>Notice that the <code><a class="el" href="../../d0/d12/classengine_1_1core_1_1App.html#acc2f37b3d37c13155d03e92041bf04c3" title="The first function that the engine calls to do its internal Controller classes engine_setup.">engine::core::App::engine_setup</a></code> with the suffix <code>_</code> and <code>engine::core::App::user_setup</code> are different methods. The <code>engine_setup</code> first executes the engine setup code and then calls the user implementation of the <code>setup</code>.</p>
<h1><a class="anchor" id="autotoc_md29"></a>
The MainController</h1>
<p><code>Controllers</code> are the way to hook into the <code><a class="el" href="../../d0/d12/classengine_1_1core_1_1App.html#a424c3d6b2ec7410fcde36a2c3c19d435" title="The main entry point into the App.">engine::core::App::run</a></code> method. The <code><a class="el" href="../../d1/d39/classengine_1_1core_1_1Controller.html" title="Controllers are a hook into the App main loop execution. By overriding virtual functions of this clas...">engine::core::Controller</a></code> class has virtual methods: <code><a class="el" href="../../d1/d39/classengine_1_1core_1_1Controller.html#a0e6251130770075738a5b1fa9997145f" title="Initializes the controller. Executes in the core::App::initialize.">engine::core::Controller::initialize</a></code>, <code><a class="el" href="../../d1/d39/classengine_1_1core_1_1Controller.html#ab4e21c7ff67605a5bb55e916aa0285a3" title="Checks whether the main loop should continue. Executes in the core::App::loop.">engine::core::Controller::loop</a></code>, <code><a class="el" href="../../d1/d39/classengine_1_1core_1_1Controller.html#acb6fd64fc7fb4ebf9743cc36b43fc8ce" title="Process internal and external events. Executes in the core::App::poll_events.">engine::core::Controller::poll_events</a></code>, <code><a class="el" href="../../d1/d39/classengine_1_1core_1_1Controller.html#ad8df371f4b9ca33960b65250090f5174" title="Update the controller state and prepare for drawing. Executes in the core::App::update.">engine::core::Controller::update</a></code>, <code><a class="el" href="../../d1/d39/classengine_1_1core_1_1Controller.html#ab3fa444218130f3de4b5212a4882e723" title="Draw the world state. Executes in the core::App::draw.">engine::core::Controller::draw</a></code>, and <code><a class="el" href="../../d1/d39/classengine_1_1core_1_1Controller.html#af3e3b7e58edd564f73d290d69dd58d74" title="Terminate the controller. Executes in the core::App::terminate.">engine::core::Controller::terminate</a></code> that we can override in our custom Controller implementation and have the <code>engine</code> execute them.</p>
<p>Let's create an <code><a class="el" href="../../d1/d39/classengine_1_1core_1_1Controller.html" title="Controllers are a hook into the App main loop execution. By overriding virtual functions of this clas...">engine::core::Controller</a></code> implementation, call it <code>MainController</code>:</p>
<p>Create <code><a class="el" href="../../d2/d7a/MainController_8hpp.html">MainController.hpp</a></code> in the <code>include/</code> directory:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MainController final : <span class="keyword">public</span> <a class="code" href="../../d1/d39/classengine_1_1core_1_1Controller.html">engine::core::Controller</a> {</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="../../d1/d39/classengine_1_1core_1_1Controller.html#a0e6251130770075738a5b1fa9997145f">initialize</a>() <span class="keyword">override</span>;</div>
<div class="line">};</div>
<div class="ttc" id="aclassengine_1_1core_1_1Controller_html"><div class="ttname"><a href="../../d1/d39/classengine_1_1core_1_1Controller.html">engine::core::Controller</a></div><div class="ttdoc">Controllers are a hook into the App main loop execution. By overriding virtual functions of this clas...</div><div class="ttdef"><b>Definition:</b> Controller.hpp:42</div></div>
<div class="ttc" id="aclassengine_1_1core_1_1Controller_html_a0e6251130770075738a5b1fa9997145f"><div class="ttname"><a href="../../d1/d39/classengine_1_1core_1_1Controller.html#a0e6251130770075738a5b1fa9997145f">engine::core::Controller::initialize</a></div><div class="ttdeci">virtual void initialize()</div><div class="ttdoc">Initializes the controller. Executes in the core::App::initialize.</div><div class="ttdef"><b>Definition:</b> Controller.hpp:129</div></div>
</div><!-- fragment --><p>and <code><a class="el" href="../../dc/d21/MainController_8cpp.html">MainController.cpp</a></code> in the <code>src/</code> directory:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d2/d7a/MainController_8hpp.html">app/MainController.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;spdlog/spdlog.h&gt;</span></div>
<div class="line"><span class="keywordtype">void</span> MainController::initialize() {</div>
<div class="line">    spdlog::info(<span class="stringliteral">&quot;Hello, from the main controller initialization!&quot;</span>);</div>
<div class="line">}</div>
<div class="ttc" id="aMainController_8hpp_html"><div class="ttname"><a href="../../d2/d7a/MainController_8hpp.html">MainController.hpp</a></div></div>
</div><!-- fragment --><p>If we ran the app at this point, we won't see anything change in log, because although we created an <code><a class="el" href="../../d1/d39/classengine_1_1core_1_1Controller.html" title="Controllers are a hook into the App main loop execution. By overriding virtual functions of this clas...">engine::core::Controller</a></code> implementation we didn't register our implementation to the <code>engine</code>. To register an <code><a class="el" href="../../d1/d39/classengine_1_1core_1_1Controller.html" title="Controllers are a hook into the App main loop execution. By overriding virtual functions of this clas...">engine::core::Controller</a></code> implementation and have the <code>engine</code> execute it, we have to call <code><a class="el" href="../../d0/d12/classengine_1_1core_1_1App.html#af2826315f3808f52416448beb42c1fa3" title="Registers the controller for execution. The Controller instance that the register_controller returns ...">engine::core::App::register_controller</a></code> during <code>TestApp::user_setup</code>:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> TestApp::user_setup() {</div>
<div class="line">    spdlog::info(<span class="stringliteral">&quot;Hello, from the main controller initialization!&quot;</span>);</div>
<div class="line">    <span class="keyword">auto</span> main_controller = engine::core::App::register_controller&lt;MainController&gt;();</div>
<div class="line">    main_controller-&gt;after(engine::core::App::get_controller&lt;controller::EngineControllersEnd&gt;());</div>
<div class="line">}</div>
</div><!-- fragment --><p>The <code><a class="el" href="../../d0/d12/classengine_1_1core_1_1App.html#af2826315f3808f52416448beb42c1fa3" title="Registers the controller for execution. The Controller instance that the register_controller returns ...">engine::core::App::register_controller</a>&lt;T&gt;</code> returns a <code>T*</code> to the instance of a controller. Since there can be multiple controllers in the <code>app</code>, as we'll see later, the <code>engine</code> provides a mechanism to order their execution. By calling:</p>
<div class="fragment"><div class="line">main_controller-&gt;after(engine::core::App::get_controller&lt;controller::EngineControllersEnd&gt;());</div>
</div><!-- fragment --><p>we ensure that our <code>MainController</code> will always execute after all the <code>engine</code> controllers. The <code>engine::core::App::get_controller&lt;controller::EngineControllersEnd&gt;()</code> retrieves an instance of a <code>controller::EngineControllersEnd</code> that serves as a sentinel between engine controllers and our controllers, and the call to <code>main_controller-&gt;after(c)</code> will tell the <code>engine</code> that the <code>main_controller</code> should always execute after whatever is the controller <code>c</code>.</p>
<p>When we run the app now, in the log we should find the following:</p>
<div class="fragment"><div class="line">...</div>
<div class="line">[2024-12-14 19:01:07.471] [info] EngineControllersEnd::initialize</div>
<div class="line">[2024-12-14 19:01:07.471] [info] N6engine4test3app14MainControllerE::initialize</div>
<div class="line">[2024-12-14 19:01:07.471] [info] Hello, from the main controller initialization!</div>
<div class="line">...</div>
</div><!-- fragment --><p><code>EngineControllersEnd::initialize</code> means that all the engine controllers are initialized at this point.</p>
<p><code>N6engine4test3app14MainControllerE::initialize</code> is the engine informing us that it called the <code>MainController::initialize</code> at this point, and right after we see <code>Hello, from the main controller initialization!</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
